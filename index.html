
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Life Lists - Organize everything in one place">
    <title>Life Lists - Task Manager</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- PWA Meta Tags for Mobile -->
    <meta name="theme-color" content="#1f2937">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Life Lists">
    
    <style>
        /* Prevent zoom on input focus for iOS */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* Loading animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <!-- Cloud Storage Polyfill for GitHub Pages -->
    <script>
        // Simple storage polyfill using localStorage as fallback
        if (!window.storage) {
            window.storage = {
                get: async function(key) {
                    const value = localStorage.getItem(key);
                    if (value === null) {
                        throw new Error('Key not found');
                    }
                    return { key, value, shared: false };
                },
                set: async function(key, value) {
                    localStorage.setItem(key, value);
                    return { key, value, shared: false };
                },
                delete: async function(key) {
                    localStorage.removeItem(key);
                    return { key, deleted: true, shared: false };
                },
                list: async function(prefix) {
                    const keys = [];
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (!prefix || key.startsWith(prefix)) {
                            keys.push(key);
                        }
                    }
                    return { keys, prefix, shared: false };
                }
            };
        }
    </script>
    
    <!-- App Component -->
    <script type="text/babel">
        const { useState, useEffect } = React;

        const categories = ['Life General', 'Parenting', 'TV/Movies', 'Shopping', 'Travel'];

        function LifeLists() {
          const [tasks, setTasks] = useState([]);
          const [newTask, setNewTask] = useState('');
          const [selectedCategory, setSelectedCategory] = useState('Life General');
          const [activeMode, setActiveMode] = useState('All');
          const [loading, setLoading] = useState(true);
          const [saving, setSaving] = useState(false);

          // Load tasks from cloud storage on mount
          useEffect(() => {
            loadTasks();
          }, []);

          const loadTasks = async () => {
            try {
              const result = await window.storage.get('life-lists-tasks');
              if (result && result.value) {
                setTasks(JSON.parse(result.value));
              }
            } catch (error) {
              console.log('No saved tasks found, starting fresh');
            } finally {
              setLoading(false);
            }
          };

          // Save tasks to cloud storage whenever they change
          const saveTasks = async (newTasks) => {
            setSaving(true);
            try {
              await window.storage.set('life-lists-tasks', JSON.stringify(newTasks));
            } catch (error) {
              console.error('Error saving tasks:', error);
              alert('Failed to save tasks. Please try again.');
            } finally {
              setSaving(false);
            }
          };

          const addTask = () => {
            if (newTask.trim()) {
              const task = {
                id: Date.now(),
                text: newTask,
                category: selectedCategory,
                completed: false
              };
              const updatedTasks = [task, ...tasks];
              setTasks(updatedTasks);
              saveTasks(updatedTasks);
              setNewTask('');
            }
          };

          const handleKeyPress = (e) => {
            if (e.key === 'Enter') {
              e.preventDefault();
              addTask();
            }
          };

          const toggleTask = (id) => {
            const updatedTasks = tasks.map(task =>
              task.id === id ? { ...task, completed: !task.completed } : task
            );
            setTasks(updatedTasks);
            saveTasks(updatedTasks);
          };

          const deleteTask = (id) => {
            const updatedTasks = tasks.filter(task => task.id !== id);
            setTasks(updatedTasks);
            saveTasks(updatedTasks);
          };

          const filteredTasks = activeMode === 'All' 
            ? tasks 
            : tasks.filter(task => task.category === activeMode);

          const getCategoryColor = (category) => {
            const colors = {
              'Life General': 'bg-blue-100 text-blue-700',
              'Parenting': 'bg-pink-100 text-pink-700',
              'TV/Movies': 'bg-purple-100 text-purple-700',
              'Shopping': 'bg-green-100 text-green-700',
              'Travel': 'bg-orange-100 text-orange-700'
            };
            return colors[category] || 'bg-gray-100 text-gray-700';
          };

          if (loading) {
            return (
              <div className="min-h-screen bg-blue-50 flex items-center justify-center">
                <div className="text-center">
                  <div className="text-4xl mb-4">‚è≥</div>
                  <p className="text-gray-600">Loading your lists...</p>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-blue-50 p-4 sm:p-8">
              <div className="max-w-4xl mx-auto">
                {/* Header */}
                <div className="mb-8">
                  <div className="flex items-center justify-between">
                    <div>
                      <h1 className="text-3xl font-light text-gray-800 mb-2">Life Lists</h1>
                      <p className="text-gray-500 text-sm">Organize everything in one place</p>
                    </div>
                    {saving && (
                      <div className="text-sm text-gray-500 flex items-center gap-2">
                        <span className="animate-pulse">üíæ</span>
                        Saving...
                      </div>
                    )}
                  </div>
                </div>

                {/* Mode Buttons */}
                <div className="mb-6 flex flex-wrap gap-2">
                  <button
                    onClick={() => setActiveMode('All')}
                    className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                      activeMode === 'All'
                        ? 'bg-gray-800 text-white shadow-md'
                        : 'bg-white text-gray-600 hover:bg-gray-100 border border-gray-200'
                    }`}
                  >
                    All Tasks
                  </button>
                  {categories.map(category => (
                    <button
                      key={category}
                      onClick={() => {
                        setActiveMode(category);
                        setSelectedCategory(category);
                      }}
                      className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                        activeMode === category
                          ? 'bg-gray-800 text-white shadow-md'
                          : 'bg-white text-gray-600 hover:bg-gray-100 border border-gray-200'
                      }`}
                    >
                      {category} Mode
                    </button>
                  ))}
                </div>

                {/* Master Inbox */}
                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                  <h2 className="text-lg font-medium text-gray-800 mb-4">Master Inbox</h2>
                  <div className="space-y-4">
                    <input
                      type="text"
                      value={newTask}
                      onChange={(e) => setNewTask(e.target.value)}
                      onKeyPress={handleKeyPress}
                      placeholder="What needs to be done?"
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent"
                    />
                    <div className="flex gap-3">
                      <select
                        value={selectedCategory}
                        onChange={(e) => setSelectedCategory(e.target.value)}
                        className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent bg-white"
                      >
                        {categories.map(cat => (
                          <option key={cat} value={cat}>{cat}</option>
                        ))}
                      </select>
                      <button
                        type="button"
                        onClick={addTask}
                        disabled={saving}
                        className="px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2 font-medium disabled:opacity-50"
                      >
                        <span className="text-xl leading-none">+</span>
                        Add Task
                      </button>
                    </div>
                  </div>
                </div>

                {/* Task List */}
                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                  <div className="flex items-center justify-between mb-4">
                    <h2 className="text-lg font-medium text-gray-800">
                      {activeMode === 'All' ? 'All Tasks' : `${activeMode} Tasks`}
                    </h2>
                    <span className="text-sm text-gray-500">
                      {filteredTasks.length} {filteredTasks.length === 1 ? 'task' : 'tasks'}
                    </span>
                  </div>

                  {filteredTasks.length === 0 ? (
                    <div className="text-center py-12 text-gray-400">
                      <div className="text-5xl mb-3 opacity-50">üìã</div>
                      <p>No tasks yet. Add one above!</p>
                    </div>
                  ) : (
                    <div className="space-y-2">
                      {filteredTasks.map(task => (
                        <div
                          key={task.id}
                          className="flex items-center gap-3 p-4 rounded-lg hover:bg-gray-50 transition-colors border border-gray-100"
                        >
                          <input
                            type="checkbox"
                            checked={task.completed}
                            onChange={() => toggleTask(task.id)}
                            className="w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-2 focus:ring-gray-400 cursor-pointer"
                          />
                          <div className="flex-1 min-w-0">
                            <p className={`${task.completed ? 'line-through text-gray-400' : 'text-gray-800'}`}>
                              {task.text}
                            </p>
                          </div>
                          <span className={`px-3 py-1 rounded-full text-xs font-medium ${getCategoryColor(task.category)}`}>
                            {task.category}
                          </span>
                          <button
                            onClick={() => deleteTask(task.id)}
                            className="text-gray-400 hover:text-red-500 transition-colors text-2xl leading-none px-2"
                          >
                            √ó
                          </button>
                        </div>
                      ))}
                    </div>
                  )}
                </div>

                {/* Stats */}
                <div className="mt-6 grid grid-cols-2 sm:grid-cols-3 gap-4">
                  {categories.map(category => {
                    const count = tasks.filter(t => t.category === category).length;
                    return (
                      <div key={category} className="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
                        <p className="text-gray-500 text-xs mb-1">{category}</p>
                        <p className="text-2xl font-light text-gray-800">{count}</p>
                      </div>
                    );
                  })}
                  <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
                    <p className="text-gray-500 text-xs mb-1">Completed</p>
                    <p className="text-2xl font-light text-gray-800">
                      {tasks.filter(t => t.completed).length}
                    </p>
                  </div>
                </div>

                {/* Storage Info */}
                <div className="mt-8 text-center text-xs text-gray-400">
                  <p>üíæ Your lists are saved locally</p>
                  <p className="mt-1">Bookmark this page to access from any device</p>
                </div>
              </div>
            </div>
          );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LifeLists />);
    </script>
</body>
</html>
